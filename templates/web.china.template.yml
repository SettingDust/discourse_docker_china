hooks:
  before_web:
    - exec:
       cmd:
         - gem sources --add https://gems.ruby-china.com/ --remove https://rubygems.org/
         - git config --global url."https://hub.fastgit.org/".insteadOf "https://github.com/"

  before_code:
    - exec:
       cmd:
         - git config --global url."https://hub.fastgit.org/".insteadOf "https://github.com/"
         - wget https://raw.githubusercontent.com/SettingDust/discourse_docker_china/main/discourse.patch
         - git apply discourse.patch

  before_bundle_exec:
    - exec:
       cmd:
         - su discourse -c 'bundle config mirror.https://rubygems.org https://gems.ruby-china.com/'
